{"ast":null,"code":"import { create } from 'zustand';\nimport { productApi } from '../api/api';\nconst useSearchStore = create((set, get) => ({\n  // 状态\n  searchQuery: '',\n  searchResults: [],\n  isLoading: false,\n  error: null,\n  currentPage: 1,\n  totalPages: 1,\n  totalResults: 0,\n  // 动作\n  search: async query => {\n    // 新搜索时重置页码\n    set({\n      searchQuery: query,\n      isLoading: true,\n      error: null,\n      currentPage: 1\n    });\n    try {\n      const data = await productApi.searchProducts(query, 1);\n      set({\n        searchResults: data.items || [],\n        totalResults: data.total || 0,\n        totalPages: data.pages || 1,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('搜索失败:', err);\n      set({\n        error: '搜索失败，请稍后再试',\n        searchResults: [],\n        isLoading: false\n      });\n    }\n  },\n  loadNextPage: async () => {\n    const {\n      searchQuery,\n      currentPage,\n      totalPages\n    } = get();\n    if (currentPage >= totalPages) return;\n    const nextPage = currentPage + 1;\n    set({\n      isLoading: true,\n      error: null\n    });\n    try {\n      const data = await productApi.searchProducts(searchQuery, nextPage);\n      set({\n        searchResults: data.items || [],\n        currentPage: nextPage,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('加载下一页失败:', err);\n      set({\n        error: '加载更多产品失败，请稍后再试',\n        isLoading: false\n      });\n    }\n  },\n  loadPrevPage: async () => {\n    const {\n      searchQuery,\n      currentPage\n    } = get();\n    if (currentPage <= 1) return;\n    const prevPage = currentPage - 1;\n    set({\n      isLoading: true,\n      error: null\n    });\n    try {\n      const data = await productApi.searchProducts(searchQuery, prevPage);\n      set({\n        searchResults: data.items || [],\n        currentPage: prevPage,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('加载上一页失败:', err);\n      set({\n        error: '加载产品失败，请稍后再试',\n        isLoading: false\n      });\n    }\n  },\n  // 重置搜索状态\n  resetSearch: () => {\n    set({\n      searchQuery: '',\n      searchResults: [],\n      isLoading: false,\n      error: null,\n      currentPage: 1,\n      totalPages: 1,\n      totalResults: 0\n    });\n  }\n}));\nexport default useSearchStore;","map":{"version":3,"names":["create","productApi","useSearchStore","set","get","searchQuery","searchResults","isLoading","error","currentPage","totalPages","totalResults","search","query","data","searchProducts","items","total","pages","err","console","loadNextPage","nextPage","loadPrevPage","prevPage","resetSearch"],"sources":["/Users/edson/ecommerce-ai-assistant/frontend/src/store/searchStore.js"],"sourcesContent":["import { create } from 'zustand';\nimport { productApi } from '../api/api';\n\nconst useSearchStore = create((set, get) => ({\n  // 状态\n  searchQuery: '',\n  searchResults: [],\n  isLoading: false,\n  error: null,\n  currentPage: 1,\n  totalPages: 1,\n  totalResults: 0,\n  \n  // 动作\n  search: async (query) => {\n    // 新搜索时重置页码\n    set({ \n      searchQuery: query, \n      isLoading: true, \n      error: null,\n      currentPage: 1\n    });\n    \n    try {\n      const data = await productApi.searchProducts(query, 1);\n      set({\n        searchResults: data.items || [],\n        totalResults: data.total || 0,\n        totalPages: data.pages || 1,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('搜索失败:', err);\n      set({\n        error: '搜索失败，请稍后再试',\n        searchResults: [],\n        isLoading: false\n      });\n    }\n  },\n  \n  loadNextPage: async () => {\n    const { searchQuery, currentPage, totalPages } = get();\n    if (currentPage >= totalPages) return;\n    \n    const nextPage = currentPage + 1;\n    set({ isLoading: true, error: null });\n    \n    try {\n      const data = await productApi.searchProducts(searchQuery, nextPage);\n      set({\n        searchResults: data.items || [],\n        currentPage: nextPage,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('加载下一页失败:', err);\n      set({\n        error: '加载更多产品失败，请稍后再试',\n        isLoading: false\n      });\n    }\n  },\n  \n  loadPrevPage: async () => {\n    const { searchQuery, currentPage } = get();\n    if (currentPage <= 1) return;\n    \n    const prevPage = currentPage - 1;\n    set({ isLoading: true, error: null });\n    \n    try {\n      const data = await productApi.searchProducts(searchQuery, prevPage);\n      set({\n        searchResults: data.items || [],\n        currentPage: prevPage,\n        isLoading: false\n      });\n    } catch (err) {\n      console.error('加载上一页失败:', err);\n      set({\n        error: '加载产品失败，请稍后再试',\n        isLoading: false\n      });\n    }\n  },\n  \n  // 重置搜索状态\n  resetSearch: () => {\n    set({\n      searchQuery: '',\n      searchResults: [],\n      isLoading: false,\n      error: null,\n      currentPage: 1,\n      totalPages: 1,\n      totalResults: 0\n    });\n  }\n}));\n\nexport default useSearchStore;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}